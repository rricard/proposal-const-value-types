<!DOCTYPE html>
<meta charset="utf8" />

<emu-clause id="sec-ordinary-and-exotic-objects-behaviours">
  <h1>Ordinary and Exotic Objects Behaviours</h1>

  <emu-clause id="sec-built-in-exotic-object-internal-methods-and-slots">
    <h1>Built-in Exotic Object Internal Methods and Slots</h1>
    <emu-clause id="sec-record-exotic-objects">
      <h1>Record Exotic Objects</h1>
      <p>A Record object is an exotic object that encapsuates a Record value and exposes virtual string-indexed data properties corresponding to the individual keys set on the underlying Record value. All keys properties are non-writable and non-configurable.</p>

      <p>An object is a <dfn id="record-exotic-object">Record exotic object</dfn> (or simply, a Record object) if its following internal methods use the following implementations. These methods are installed in RecordCreate.</p>

      <p>Record exotic objects have the same internal slots as ordinary objects. They also have a [[RecordData]] internal slot.</p>

      <emu-clause id="sec-record-exotic-objects-setprototypeof-v">
        <h1>[[SetPrototypeOf]] ( _V_ )</h1>
        <p>When the [[SetPrototypeOf]] internal method of a Record exotic object _R_ is called with argument _V_, the following steps are taken:</p>
        <emu-alg>
          1. Return ? SetImmutablePrototype(_R_, _V_).
        </emu-alg>
      </emu-clause>
      
      <emu-clause id="sec-record-exotic-objects-isextensible">
        <h1>[[IsExtensible]] ()</h1>
        <p>When the [[IsExtensible]] internal method of a Record exotic object _R_ is called, the following steps are taken:</p>
        <emu-alg>
          1. Return *false*.
        </emu-alg>
      </emu-clause>

      <emu-clause id="sec-record-exotic-objects-getownproperty-p">
        <h1>[[GetOwnProperty]] ( _P_ )</h1>
        <p>When the [[GetOwnProperty]] internal method of a Record exotic object _R_ is called with property key _P_, the following steps are taken:</p>
        <emu-alg>
          1. Assert: IsPropertyKey(_P_) is *true*.
          1. If Type(_P_) is a Symbol, return *undefined*.
          1. Return ! RecordGetOwnProperty(_R_, _P_).
        </emu-alg>
      </emu-clause>

      <emu-clause id="sec-record-exotic-objects-defineownproperty-p-desc">
        <h1>[[DefineOwnProperty]] ( _P_, _Desc_ )</h1>
        <p>When the [[DefineOwnProperty]] internal method of a Record exotic object _R_ is called with property key _P_, and Property Descriptor _Desc_ the following steps are taken:</p>
        <emu-alg>
          1. Assert: IsPropertyKey(_P_) is *true*.
          1. Let _current_ be ? _R_.[[GetOwnProperty]](_P_).
          1. If _current_ is *undefined* return *false*.
          1. If IsAccessorDescriptor(_Desc_) is *true*, return *false*.
          1. If _Desc_.[[Writable]] is present and has value *true*, return *false*.
          1. If _Desc_.[[Enumerable]] is present and has value *false*, return *false*.
          1. If _Desc_.[[Configurable]] is present and has value *true*, return *false*.
          1. If _Desc_.[[Value]] is present, return SameValue(_Desc_.[[Value]], _current_.[[Value]]).
          1. Return *false*.
        </emu-alg>
      </emu-clause>
      
      <emu-clause id="sec-record-exotic-objects-hasproperty-p">
        <h1>[[HasProperty]] ( _P_ )</h1>
        <p>When the [[HasProperty]] internal method of a Record exotic object _R_ is called with property key _P_, the following steps are taken:</p>
        <emu-alg>
          1. Assert: IsPropertyKey(_P_) is *true*.
          1. If Type(_P_) is a Symbol, return *false*.
          1. For each pair _p_ of _rec_.[[Fields]], do
            1. Let _key_ be _p_.[[Key]]
            1. If SameValue(_key_, _P_), return *true*.
          1. Return *false*.
        </emu-alg>
      </emu-clause>
            
      <emu-clause id="sec-record-exotic-objects-get-p-receiver">
        <h1>[[Get]] ( _P_, _Receiver_ )</h1>
        <p>When the [[Get]] internal method of a Record exotic object _R_ is called with property key _P_ and ECMAScript language value _Receiver_, the following steps are taken:</p>
        <emu-alg>
          1. Let _ownProperty_ be ? RecordGetOwnProperty( _R_, _P_ ).
          1. If _ownProperty_ is *undefined*, return *undefined*.
          1. Return _ownProperty_.[[Value]].
        </emu-alg>
      </emu-clause>

      <emu-clause id="sec-record-exotic-objects-set-p-receiver">
        <h1>[[Set]] ( _P_, _Receiver_ )</h1>
        <p>When the [[Set]] internal method of a Record exotic object _R_ is called with property key _P_ and ECMAScript language value _Receiver_, the following steps are taken:</p>
        <emu-alg>
          1. Return *false*.
        </emu-alg>
      </emu-clause>

      <emu-clause id="sec-record-exotic-objects-delete-p">
        <h1>[[Delete]] ( _P_ )</h1>
        <p>When the [[Delete]] internal method of a Record exotic object _R_ is called with property key _P_, the following steps are taken:</p>
        <emu-alg>
          1. Return *false*.
        </emu-alg>
      </emu-clause>

      <emu-clause id="sec-record-exotic-objects-ownpropertykeys">
        <h1>[[OwnPropertyKeys]] ( )</h1>
        <p>When the [[OwnPropertyKeys]] internal method of a Record exotic object _R_ is called, the following steps are taken:</p>
        <emu-alg>
          1. Let _keys_ be a new empty List.
          1. Let _rec_ be _R_.[[RecordData]].
          1. Assert: Type(_rec_) is Record.
          1. Let _len_ be the length of _rec_.
          1. For each pair _p_ of _rec_.[[Fields]], do
            1. Let _key_ be _p_.[[Key]]
            1. Assert: Type(_key_) is String
            1. Add _key_ to _keys_
          1. Return _keys_
        </emu-alg>
      </emu-clause>

      <emu-clause id="sec-recordcreate" aoid="RecordCreate">
        <h1>RecordCreate ( _value_ )</h1>
        <p>This abstract operation RecordCreate takes a _value_ argument. It is used to specify the creation of new Record exotic objects. It performs the following steps when called:</p>
        <emu-alg>
            1. Assert: Type(_value_) is a Record.
            1. Assert: Type(_value_.[[Fields]]) is a List.
            1. Let _R_ be ! MakeBasicObject(&laquo; [[RecordData]] &raquo;).
            1. Set _R_'s essential internal methods to the definitions specified in <emu-xref href="#sec-record-exotic-objects"></emu-xref>.
            1. Set _R_.[[Prototype]] to *null*.
            1. Set _R_.[[RecordData]] to _value_.
            1. OrdinaryPreventExtensions(_R_).
            1. Return _R_
            
        </emu-alg>
      </emu-clause>

      <emu-clause id="sec-recordgetownproperty-r-p" aoid="RecordGetOwnProperty">
        <h1>RecordGetOwnProperty ( _R_, _P_ )</h1>
        <p>This abstract operation RecordGetOwnProperty takes arguments _R_ and _P_. It performs the following steps when called:</p>
        <emu-alg>
            1. Assert: _R_ is an Object that has [[RecordData]] internal slot.
            1. Assert: Type(_P_) is String.
            1. Let _rec_ be _R_.[[RecordData]]
            1. Assert Type(rec) is Record
            1. Let _len_ be the length of _rec_.
            1. Let _resultPrim_ be ~empty~
            1. For each pair _p_ of _rec_.[[Fields]], do
              1. Let _key_ be _p_.[[Key]]
              1. Let _prim_ be _p_.[[Value]]
              1. Assert: Type(_key_) is String
              1. Assert: Type(_prim_) is not Object
              1. If SameValue(_key_, _P_), let _resultPrim_ be _prim_
            1. If _resultPrim_ is ~empty~, return *undefined*
            1. Return the PropertyDescriptor { [[Value]]: _resultPrim_, [[Writable]]: *false*, [[Enumerable]]: *true*, [[Configurable]]: *false* }.
        </emu-alg>
      </emu-clause>
    </emu-clause>
  </emu-clause>
</emu-clause>
